<!DOCTYPE html>
<html>
	<body>
		<div id='loading'>
		Joining game...
		</div>
		<div id='guess' style='display: none;'>
			You are on team <span id='team-name'></span>
			<input type='text' id='guessbox' />
			<button id='submit'>guess!</button>
		</div>
		<script type='text/javascript' src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script type='text/javascript' src="/socket.io/socket.io.js"></script>
		<script type='text/javascript'>
		var socket = io.connect();
		socket.emit('join-game', { id: getParam('id'), player: { name: 'RTigger', score: 0 } });
		socket.on('joined', function(data) {
			$('#loading').hide();
			$('#guess').show();
			$('#team-name').text(data.team.name);
		});
		
		socket.on('legit', function() {
			$('#guessbox').val('');
		});
		
		socket.on('fail', function() {
			$('#guessbox').val('');
		});
		
		$('#submit').bind('click', function() {
			var guess = $('#guessbox').val();
			socket.emit('guess', { guess: guess });
		});

		function getParam(name) {
			name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
			var regexS = "[\\?&]" + name + "=([^&#]*)";
			var regex = new RegExp(regexS);
			var results = regex.exec(window.location.search);
			if(results == null)
				return "";
			else
				return decodeURIComponent(results[1].replace(/\+/g, " "));
		}
		</script>

	</body>
</html>